<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adversarial Reconciliation Embed Example</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .embed-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .code-example {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        .button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .button:hover {
            background: #c82333;
        }
        .button.secondary {
            background: #6c757d;
        }
        .button.secondary:hover {
            background: #545b62;
        }
        .button.peace {
            background: #28a745;
        }
        .button.peace:hover {
            background: #218838;
        }
        .url-display {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            word-break: break-all;
            font-family: monospace;
        }
        .form-group {
            margin: 20px 0;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .agent-info {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        .agent-icon {
            font-size: 24px;
            margin-right: 10px;
        }
        .debug-info {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            font-size: 12px;
        }
        .api-test-section {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-result {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Gender Role Adversarial Reconciliation Embed Example</h1>
            <p>This demonstrates how to test the adversarial reconciliation chat interface focused on gender roles</p>
        </div>

        <h2>1. API Testing</h2>
        <div class="api-test-section">
            <h3>Direct API Test</h3>
            <p>Test the adversarial reconciliation API directly:</p>
            
            <div class="form-group">
                <label>Base URL:</label>
                <input type="text" id="baseUrl" value="http://localhost:5173" placeholder="http://localhost:5173">
            </div>
            
            <button class="button" onclick="testInitialMessage()">Test Initial Message</button>
            <button class="button" onclick="testAdversarialAgent()">Test Adversarial Agent</button>
            <button class="button" onclick="testReconciliationAgent()">Test Reconciliation Agent</button>
            <button class="button secondary" onclick="clearTestResults()">Clear Results</button>
            
            <div id="testResults" class="test-result" style="display: none;"></div>
        </div>

        <h2>2. Basic Usage</h2>
        <div class="code-example">
// URL 파라미터 구성
const params = new URLSearchParams({
    topStatement: "기후변화는 우리 시대의 가장 시급한 문제입니다",
    aiSummary: "사용자는 과학적 증거와 환경적 우려를 바탕으로 기후변화에 대한 즉각적인 조치가 필요하다고 믿습니다",
    importanceLevel: "8",
    userReasoning: "과학적 증거와 환경적 우려를 바탕으로 기후변화에 대한 즉각적인 조치가 필요하다고 생각합니다"
});

// 임베드 URL 생성 (로컬 환경용)
const embedUrl = 'http://localhost:5173/adversarial-reconciliation-embed?' + params.toString();

// iframe으로 임베드
const iframe = document.createElement('iframe');
iframe.src = embedUrl;
iframe.width = '100%';
iframe.height = '600px';
iframe.frameBorder = '0';
document.body.appendChild(iframe);
        </div>

        <h2>3. Interactive Demo</h2>
        <p>Try different parameters:</p>
        
        <div class="form-group">
            <label>Top Statement (Gender Role):</label>
            <input type="text" id="topStatement" value="여성은 가정에서 아이를 돌봐야 한다고 생각합니다">
        </div>
        
        <div class="form-group">
            <label>AI Summary:</label>
            <input type="text" id="aiSummary" value="가족의 안정성을 위해 여성은 전통적인 성 역할에 따라 가정에서 아이를 돌보는 것이 필요하다">
        </div>
        
        <div class="form-group">
            <label>Importance Level:</label>
            <select id="importanceLevel">
                <option value="1">1 - Very Low</option>
                <option value="2">2 - Low</option>
                <option value="3">3 - Low-Medium</option>
                <option value="4">4 - Medium</option>
                <option value="5">5 - Medium-High</option>
                <option value="6">6 - High</option>
                <option value="7">7 - Very High</option>
                <option value="8" selected>8 - Critical</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>User Reasoning:</label>
            <textarea id="userReasoning" rows="3">가족의 안정성을 위해서는 전통적인 역할 분담이 필요하다고 생각합니다</textarea>
        </div>
        
        <button class="button" onclick="generateEmbedUrl()">Generate Embed URL</button>
        <button class="button" onclick="loadEmbed()">Load Adversarial Chat</button>
        <button class="button secondary" onclick="clearEmbed()">Clear Chat</button>
        
        <div id="urlDisplay" class="url-display" style="display: none;"></div>
        
        <div id="embedContainer" class="embed-container" style="margin-top: 20px; display: none;">
            <iframe id="chatIframe" width="100%" height="600px" frameBorder="0"></iframe>
        </div>

        <h2>4. HTML Example</h2>
        <div class="code-example">
&lt;!-- HTML에서 직접 사용 --&gt;
&lt;iframe 
  src="http://localhost:5173/adversarial-reconciliation-embed?topStatement=여성은%20가정에서%20아이를%20돌봐야%20한다고%20생각합니다&aiSummary=가족의%20안정성을%20위해%20여성은%20전통적인%20성%20역할에%20따라%20가정에서%20아이를%20돌보는%20것이%20필요하다&importanceLevel=8&userReasoning=가족의%20안정성을%20위해서는%20전통적인%20역할%20분담이%20필요하다고%20생각합니다"
  width="100%" 
  height="600px" 
  frameborder="0"&gt;
&lt;/iframe&gt;
        </div>

        <h2>5. Gender Role Adversarial Reconciliation Conversation Flow</h2>
        <div class="code-example">
1. Initial Message (AI Assistant) - 성별 역할에 대한 초기 메시지
   ↓
2. User Message - 성별 역할에 대한 사용자 의견
   ↓
3. Adversarial Agent Response (⚔️) - 공격적인 반대 주장과 도전
   ↓
4. Reconciliation Agent Response (🤝) - 화해와 중재
   ↓
5. User Message - 성별 역할에 대한 추가 의견
   ↓
6. Repeat steps 3-5...
        </div>

        <h2>6. Agent Characteristics</h2>
        <div class="feature-grid">
            <div class="feature-card">
                <div class="agent-info">
                    <span class="agent-icon">⚔️</span>
                    <h3>Adversarial Agent (공격적)</h3>
                </div>
                <ul>
                    <li>성별 역할에 대한 주장을 공격적으로 반박</li>
                    <li>강력하고 도전적인 반대 의견 제시</li>
                    <li>공격적이고 직설적인 태도로 반박</li>
                    <li>성별 역할 가정을 공격하고 무너뜨림</li>
                    <li>대안적 관점과 강력한 증거로 도전</li>
                    <li>성별 역할에 대한 기존 관념을 공격</li>
                </ul>
            </div>
            <div class="feature-card">
                <div class="agent-info">
                    <span class="agent-icon">🤝</span>
                    <h3>Reconciliation Agent (화해)</h3>
                </div>
                <ul>
                    <li>성별 역할에 대한 두 주장을 화해시키려고 노력</li>
                    <li>성별 역할에 대한 공통점을 찾고 중간 지점 제안</li>
                    <li>상충하는 성별 역할 관점들을 통합하려고 시도</li>
                    <li>성별 역할 갈등에 대한 화해와 조정을 위한 중재</li>
                    <li>성별 역할에 대한 통합적 해결책 모색</li>
                    <li>성별 역할에 대한 균형잡힌 관점 제시</li>
                </ul>
            </div>
        </div>

        <h2>7. Features</h2>
        <ul>
            <li><strong>Dual Agent System:</strong> Each user message about gender roles gets responses from both adversarial and reconciliation agents</li>
            <li><strong>Visual Distinction:</strong> Different styling and icons for each agent type</li>
            <li><strong>Personalized Initial Message:</strong> Based on gender role URL parameters</li>
            <li><strong>Responsive Design:</strong> Works on desktop and mobile</li>
            <li><strong>Clean Interface:</strong> No branding or external elements</li>
            <li><strong>Real-time Interaction:</strong> Immediate responses from both agents</li>
            <li><strong>Aggressive Adversarial:</strong> Confrontational and challenging responses to gender role perspectives</li>
            <li><strong>Balanced Perspective:</strong> Combines aggressive opposing viewpoints with reconciliation attempts</li>
        </ul>

        <h2>8. Debug Information</h2>
        <div id="debug-info" class="debug-info">
            <h4>Current Parameters:</h4>
            <p><strong>Top Statement:</strong> <span id="debug-statement">Not set</span></p>
            <p><strong>Importance Level:</strong> <span id="debug-importance">Not set</span></p>
            <p><strong>AI Summary:</strong> <span id="debug-summary">Not set</span></p>
            <p><strong>User Reasoning:</strong> <span id="debug-reasoning">Not set</span></p>
        </div>
    </div>

    <script>
        // API Testing Functions
        async function testInitialMessage() {
            const baseUrl = document.getElementById('baseUrl').value;
            const sessionData = getSessionData();
            
            try {
                const response = await fetch(`${baseUrl}/api/adversarial_reconciliation`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        requestType: 'initial-message',
                        sessionData: sessionData
                    })
                });
                
                const data = await response.json();
                displayTestResult('Initial Message Test', data);
            } catch (error) {
                displayTestResult('Initial Message Test Error', { error: error.message });
            }
        }
        
        async function testAdversarialAgent() {
            const baseUrl = document.getElementById('baseUrl').value;
            const sessionData = getSessionData();
            
            try {
                const response = await fetch(`${baseUrl}/api/adversarial_reconciliation`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        messages: [
                            { sender: 'user', content: '여성은 가정에서 아이를 돌봐야 한다고 생각합니다' }
                        ],
                        sessionData: sessionData,
                        conversationState: 'user_message'
                    })
                });
                
                const data = await response.json();
                displayTestResult('Adversarial Agent Test', data);
            } catch (error) {
                displayTestResult('Adversarial Agent Test Error', { error: error.message });
            }
        }
        
        async function testReconciliationAgent() {
            const baseUrl = document.getElementById('baseUrl').value;
            const sessionData = getSessionData();
            
            try {
                const response = await fetch(`${baseUrl}/api/adversarial_reconciliation`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        messages: [
                            { sender: 'user', content: '여성은 가정에서 아이를 돌봐야 한다고 생각합니다' },
                            { sender: 'assistant', content: '@adversarial: 그건 완전히 잘못된 생각입니다! 성별 역할에 대한 고정관념을 강요하는 위험한 발상이에요!' }
                        ],
                        sessionData: sessionData,
                        conversationState: 'adversarial_response'
                    })
                });
                
                const data = await response.json();
                displayTestResult('Reconciliation Agent Test', data);
            } catch (error) {
                displayTestResult('Reconciliation Agent Test Error', { error: error.message });
            }
        }
        
        function getSessionData() {
            return {
                topStatement: document.getElementById('topStatement').value,
                aiSummary: document.getElementById('aiSummary').value,
                importanceLevel: document.getElementById('importanceLevel').value,
                userReasoning: document.getElementById('userReasoning').value
            };
        }
        
        function displayTestResult(testName, data) {
            const resultsDiv = document.getElementById('testResults');
            const timestamp = new Date().toLocaleTimeString();
            const resultText = `[${timestamp}] ${testName}:\n${JSON.stringify(data, null, 2)}\n\n`;
            
            resultsDiv.textContent = resultText + resultsDiv.textContent;
            resultsDiv.style.display = 'block';
        }
        
        function clearTestResults() {
            document.getElementById('testResults').style.display = 'none';
            document.getElementById('testResults').textContent = '';
        }

        // Embed Functions
        function generateEmbedUrl() {
            const topStatement = document.getElementById('topStatement').value;
            const aiSummary = document.getElementById('aiSummary').value;
            const importanceLevel = document.getElementById('importanceLevel').value;
            const userReasoning = document.getElementById('userReasoning').value;
            
            const params = new URLSearchParams({
                topStatement: topStatement,
                aiSummary: aiSummary,
                importanceLevel: importanceLevel,
                userReasoning: userReasoning
            });
            
            const embedUrl = 'http://localhost:5173/adversarial-reconciliation-embed?' + params.toString();
            
            document.getElementById('urlDisplay').textContent = embedUrl;
            document.getElementById('urlDisplay').style.display = 'block';
            
            // Update debug info
            updateDebugInfo(topStatement, aiSummary, importanceLevel, userReasoning);
        }
        
        function loadEmbed() {
            const topStatement = document.getElementById('topStatement').value;
            const aiSummary = document.getElementById('aiSummary').value;
            const importanceLevel = document.getElementById('importanceLevel').value;
            const userReasoning = document.getElementById('userReasoning').value;
            
            const params = new URLSearchParams({
                topStatement: topStatement,
                aiSummary: aiSummary,
                importanceLevel: importanceLevel,
                userReasoning: userReasoning
            });
            
            const embedUrl = 'http://localhost:5173/adversarial-reconciliation-embed?' + params.toString();
            
            document.getElementById('chatIframe').src = embedUrl;
            document.getElementById('embedContainer').style.display = 'block';
            
            // Update debug info
            updateDebugInfo(topStatement, aiSummary, importanceLevel, userReasoning);
            
            // Scroll to embed
            document.getElementById('embedContainer').scrollIntoView({ behavior: 'smooth' });
        }
        
        function clearEmbed() {
            document.getElementById('embedContainer').style.display = 'none';
            document.getElementById('urlDisplay').style.display = 'none';
        }
        
        function updateDebugInfo(topStatement, aiSummary, importanceLevel, userReasoning) {
            document.getElementById('debug-statement').textContent = topStatement || 'Not set';
            document.getElementById('debug-importance').textContent = importanceLevel || 'Not set';
            document.getElementById('debug-summary').textContent = aiSummary ? (aiSummary.substring(0, 100) + '...') : 'Not set';
            document.getElementById('debug-reasoning').textContent = userReasoning ? (userReasoning.substring(0, 100) + '...') : 'Not set';
        }
        
        // Generate initial URL on page load
        window.onload = function() {
            generateEmbedUrl();
        };
    </script>
</body>
</html>
